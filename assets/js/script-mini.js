window.addEventListener("scroll",()=>{const e=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100;e>=25&&dataLayer.push({event:"scroll_depth",scroll_percentage:25}),e>=50&&dataLayer.push({event:"scroll_depth",scroll_percentage:50}),e>=75&&dataLayer.push({event:"scroll_depth",scroll_percentage:75}),e>=90&&dataLayer.push({event:"scroll_depth",scroll_percentage:90})},{passive:!0}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('a[href="#order-btn"], a[href="#order-btn-fr"], a[href="#order-btn-ar"], button[onclick^="openCheckoutModal"]').forEach(e=>{e.addEventListener("click",()=>{dataLayer.push({event:"cta_click",cta_label:e.innerText||"Buy Now"})})})});const e={en:{CompleteOrder:"Complete Your Order",FillDetails:"Fill out the details below to checkout.",ProductDetails:"Product Details",ProductName:"Smooth Sleep",Quantity:"Quantity",SelectQuantity:"Select a quantity",Bottle1:"1 Bottle",Bottle3:"3 Bottles",Bottle5:"5 Bottles",YourDetails:"Your Details",FullName:"Full Name",FullNamePlaceholder:"Enter Your Name*",PhoneNumber:"Phone Number",PhoneNumberPlaceholder:"+212 600-000000",ConfirmPhoneNumber:"Confirm Phone Number",ConfirmPhoneNumberPlaceholder:"Re-enter phone number",FullAddress:"Full Address",FullAddressPlaceholder:"Street, City, etc.",ValidPhone:"Please enter a valid phone number.",PhoneMismatch:"Phone numbers do not match.",SubmitOrder:"Submit Order",OrderConfirmed:"Order Confirmed!",Redirecting:"Redirecting to WhatsApp...",ConfirmDetails:"Please Confirm Your Details",OrderID:"Order ID",ConfirmName:"Name",ConfirmPhone:"Phone",ConfirmAddress:"Address",ConfirmCallTime:"Consultation Time",ConfirmDeliveryNote:"Delivery Note",ConfirmQuantity:"Quantity",ConfirmPrice:"Price",ConfirmCorrect:"Is this information correct?",EditButton:"No, Edit",ConfirmButton:"Yes, Go!",Processing:"Processing...",Next:"Next",Back:"Back",AdditionalInfo:"Additional Info",CallTime:"Preferred call time for free consultation",DeliveryNote:"Delivery Note (Optional)",DeliveryNotePlaceholder:"e.g., leave with the concierge, call upon arrival...",ClientNote:"(Client Note): please call me at {time} for consultation and confirmation",SellerNote:"(Seller Note): im replacing confirmation call to consultation call to convert maximum leads to delivered orders"},fr:{CompleteOrder:"Complétez votre commande",FillDetails:"Remplissez les détails ci-dessous pour finaliser.",ProductDetails:"Détails du produit",ProductName:"Smooth Sleep",Quantity:"Quantité",SelectQuantity:"Sélectionnez une quantité",Bottle1:"1 Bouteille",Bottle3:"3 Bouteilles",Bottle5:"5 Bouteilles",YourDetails:"Vos coordonnées",FullName:"Nom complet",FullNamePlaceholder:"Entrez votre nom complet*",PhoneNumber:"Numéro de téléphone",PhoneNumberPlaceholder:"+212 600-000000",ConfirmPhoneNumber:"Confirmez le numéro de téléphone",ConfirmPhoneNumberPlaceholder:"Retapez le numéro de téléphone",FullAddress:"Adresse complète",FullAddressPlaceholder:"Rue, Ville, etc.",ValidPhone:"Veuillez entrer un numéro de téléphone valide.",PhoneMismatch:"Les numéros de téléphone ne correspondent pas.",SubmitOrder:"Valider la commande",OrderConfirmed:"Commande confirmée !",Redirecting:"Redirection vers WhatsApp...",ConfirmDetails:"Veuillez confirmer vos informations",OrderID:"ID de commande",ConfirmName:"Nom",ConfirmPhone:"Téléphone",ConfirmAddress:"Adresse",ConfirmCallTime:"Heure de consultation",ConfirmDeliveryNote:"Note de livraison",ConfirmQuantity:"Quantité",ConfirmPrice:"Prix",ConfirmCorrect:"Ces informations sont-elles correctes ?",EditButton:"Non, Modifier",ConfirmButton:"Oui, Continuer !",Processing:"Traitement...",Next:"Suivant",Back:"Retour",AdditionalInfo:"Informations supplémentaires",CallTime:"Heure d'appel préférée pour la consultation gratuite",DeliveryNote:"Note de livraison (Facultatif)",DeliveryNotePlaceholder:"ex: laisser chez le concierge, appeler à l'arrivée...",ClientNote:"(Note client) : veuillez m'appeler au {time} pour consultation et confirmation",SellerNote:"(Note du vendeur) : je remplace l'appel de confirmation par un appel de consultation pour convertir un maximum de prospects en commandes livrées"},ar:{CompleteOrder:"أكمل طلبك",FillDetails:"املأ التفاصيل أدناه لإتمام عملية الشراء.",ProductDetails:"تفاصيل المنتج",ProductName:"سموث سليب",Quantity:"الكمية",SelectQuantity:"اختر الكمية",Bottle1:"زجاجة واحدة",Bottle3:"3 زجاجات",Bottle5:"5 زجاجات",YourDetails:"تفاصيلك الشخصية",FullName:"الاسم الكامل",FullNamePlaceholder:"أدخل اسمك الكامل*",PhoneNumber:"رقم الهاتف",PhoneNumberPlaceholder:"+212 600-000000",ConfirmPhoneNumber:"تأكيد رقم الهاتف",ConfirmPhoneNumberPlaceholder:"أعد إدخال رقم الهاتف",FullAddress:"العنوان الكامل",FullAddressPlaceholder:"الشارع، المدينة، إلخ.",ValidPhone:"الرجاء إدخال رقم هاتف صحيح.",PhoneMismatch:"رقما الهاتف غير متطابقين.",SubmitOrder:"تأكيد الطلب",OrderConfirmed:"تم تأكيد الطلب!",Redirecting:"جاري التحويل إلى واتساب...",ConfirmDetails:"الرجاء تأكيد التفاصيل الخاصة بك",OrderID:"رقم الطلب",ConfirmName:"الاسم",ConfirmPhone:"الهاتف",ConfirmAddress:"العنوان",ConfirmCallTime:"وقت الاستشارة",ConfirmDeliveryNote:"ملاحظات التسليم",ConfirmQuantity:"الكمية",ConfirmPrice:"السعر",ConfirmCorrect:"هل هذه المعلومات صحيحة؟",EditButton:"لا، تعديل",ConfirmButton:"نعم، إتمام الطلب!",Processing:"جاري المعالجة...",Next:"التالي",Back:"رجوع",AdditionalInfo:"معلومات إضافية",CallTime:"الوقت المفضل للاتصال للاستشارة المجانية",DeliveryNote:"ملاحظات التسليم (اختياري)",DeliveryNotePlaceholder:"مثال: اتركها مع البواب، اتصل عند الوصول...",ClientNote:"(ملاحظة العميل): يرجى الاتصال بي على {time} للاستشارة والتأكيد",SellerNote:"(ملاحظة البائع): أقوم باستبدال مكالمة التأكيد بمكالمة الاستشارة لتحويل الحد الأقصى من العملاء المحتملين إلى طلبات تم تسليمها"}};let t=localStorage.getItem("selectedLang")||"en";document.getElementById("page-content");const n=document.querySelectorAll(".lang-content"),o=document.querySelectorAll(".lang-switcher"),r=document.documentElement;function l(l){t=l,localStorage.setItem("selectedLang",l),r.lang=l;const i=document.getElementById("checkout-modal-body"),d=document.getElementById("form-container");"ar"===l?(i.classList.add("rtl"),i.classList.remove("ltr"),d.setAttribute("dir","rtl")):(i.classList.add("ltr"),i.classList.remove("rtl"),d.setAttribute("dir","ltr"));const a=document.getElementById("confirmation-details-box");a&&("ar"===l?(a.setAttribute("dir","rtl"),a.classList.remove("text-left"),a.classList.add("text-right")):(a.setAttribute("dir","ltr"),a.classList.remove("text-right"),a.classList.add("text-left"))),n.forEach(e=>{e.classList.remove("active"),e.id===`lang-${l}`&&e.classList.add("active")}),o.forEach(e=>{e.classList.remove("bg-indigo-600","text-white","shadow-md"),e.classList.add("text-gray-600"),e.dataset.lang===l&&(e.classList.add("bg-indigo-600","text-white","shadow-md"),e.classList.remove("text-gray-600"))}),function(n){document.getElementById("form-container")&&(t=n,document.querySelectorAll("[data-lang-key]").forEach(t=>{const o=t.getAttribute("data-lang-key");e[n]&&e[n][o]&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName?t.placeholder=e[n][o]:t.innerText=e[n][o])}))}(l)}document.querySelectorAll(".faq-question").forEach(e=>{e.addEventListener("click",()=>{const t=e.classList.contains("active");document.querySelectorAll(".faq-question").forEach(e=>e.classList.remove("active")),t||e.classList.add("active")})});const i=document.getElementById("checkout-modal-body"),d=document.getElementById("product-variant"),a=document.getElementById("product-price"),c="MAD",s=document.getElementById("form-step-1"),m=document.getElementById("form-step-2"),u=document.getElementById("form-step-3"),h=document.getElementById("next-button"),f=document.getElementById("next-button-step2"),p=document.getElementById("back-button-step2"),g=document.getElementById("back-button-step3");function y(e){s.classList.toggle("hidden",1!==e),m.classList.toggle("hidden",2!==e),u.classList.toggle("hidden",3!==e)}h.addEventListener("click",()=>{d.checkValidity()?y(2):d.reportValidity()}),f.addEventListener("click",()=>{if(E.checkValidity()&&C.checkValidity()&&N.checkValidity()&&B.checkValidity()){if(C.value.trim().length<9)return b.classList.remove("hidden"),void C.focus();if(C.value!==N.value)return I.classList.remove("hidden"),void N.focus();b.classList.add("hidden"),I.classList.add("hidden"),y(3)}else v.reportValidity()}),p.addEventListener("click",()=>{y(1)}),g.addEventListener("click",()=>{y(2)});const v=document.getElementById("checkout-form"),E=document.getElementById("full-name"),C=document.getElementById("phone-number"),N=document.getElementById("confirm-phone-number"),B=document.getElementById("full-address"),b=document.getElementById("phone-format-error"),I=document.getElementById("phone-mismatch-error"),P=document.getElementById("confirmation-modal"),L=document.getElementById("modal-content-confirm"),x=document.getElementById("confirm-button"),A=document.getElementById("confirm-button-text"),D=document.getElementById("edit-button"),T=document.getElementById("success-message"),k=document.getElementById("submit-button");function S(){a.innerHTML=`--.-- ${c}`}function F(){L.style.transform="scale(0.95)",L.style.opacity="0",k.parentElement.classList.remove("hidden"),setTimeout(()=>{P.classList.add("modal-hidden")},300)}D.addEventListener("click",function(){F(),document.getElementById("submit-button").classList.remove("hidden")}),d.addEventListener("change",function(e){const t=e.target.options[e.target.selectedIndex],n=t.getAttribute("data-price"),o=t.getAttribute("data-old-price");if(n&&"0"!==n){let e=`<span>${parseFloat(n).toFixed(0)} ${c}</span>`;o&&parseFloat(o)>parseFloat(n)&&(e+=` <s class="text-red-500 font-normal text-lg ml-2">${parseFloat(o).toFixed(0)} ${c}</s>`),a.innerHTML=e}else S()}),v.addEventListener("submit",function(n){n.preventDefault();const o=d.options[d.selectedIndex];document.getElementById("confirm-order-id").innerText=function(){const e=Date.now().toString();return`LXLY-3126-${e.substring(e.length-6)}`}(),document.getElementById("confirm-name").innerText=E.value,document.getElementById("confirm-phone").innerText=C.value,document.getElementById("confirm-address").innerText=B.value,document.getElementById("confirm-call-time").innerText=document.getElementById("note").value,document.getElementById("confirm-delivery-note").innerText=document.getElementById("delivery-note").value||"N/A",document.getElementById("confirm-variant").innerText=e[t][o.getAttribute("data-lang-key")],document.getElementById("confirm-price").innerText=`${parseFloat(o.getAttribute("data-price")).toFixed(0)} ${c}`,P.classList.remove("modal-hidden"),k.parentElement.classList.add("hidden"),setTimeout(()=>{L.style.transform="scale(1)",L.style.opacity="1"},50),document.getElementById("submit-button").classList.add("hidden")}),x.addEventListener("click",function(){x.disabled=!0,D.disabled=!0,A.innerText=e[t].Processing;const n=d.options[d.selectedIndex],o=parseFloat(n.getAttribute("data-price")).toFixed(0);let r=C.value.trim();9===r.length&&(r.startsWith("6")||r.startsWith("7"))&&(r="0"+r);const l="'"+r,a=document.getElementById("confirm-order-id").innerText,s=document.getElementById("product-title").innerText,m=document.getElementById("sku").value,u=document.getElementById("note").value,h=`${e[t].ClientNote.replace("{time}",u)}\n${e[t].SellerNote}`,f={orderId:a,productTitle:s,sku:m,productPrice:`${o} ${c}`,productVariant:d.value,clientName:E.value,clientPhone:l,clientAddress:B.value,note:h,delivery_note:document.getElementById("delivery-note").value},p=`https://wa.me/212768356015?text=${encodeURIComponent(`*New Order* 🔥\n-------------------\n*Order ID:* ${a}\n\n*Product:* ${s}\n*SKU:* ${f.sku}\n*Quantity:* ${f.productVariant} bottle(s)\n*Price:* ${f.productPrice}\n\n*Client Details:*\n*Name:* ${f.clientName}\n*Phone:* ${r}\n*Address:* ${f.clientAddress}\n\n*Consultation & Notes:*\n${f.note}\n\n*Delivery Note:* ${f.delivery_note||"None"}`.trim())}`;fetch("https://script.google.com/macros/s/AKfycbwDyvrE3gVhvxUPiXLwk_M_p_z-vO1acq2nljXK10HonrJCkne00zNIKhx7lecE5cc2ug/exec",{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}).then(()=>{var n;F(),T.classList.remove("hidden"),n={orderId:f.orderId,productPrice:o,productVariant:f.productVariant,productTitle:f.productTitle,sku:f.sku},dataLayer.push({event:"purchase",ecommerce:{transaction_id:n.orderId,value:n.productPrice,currency:"MAD",items:[{item_id:n.sku,item_name:n.productTitle,quantity:n.productVariant,price:n.productPrice}]}}),setTimeout(()=>{window.open(p,"_blank"),setTimeout(()=>{v.reset(),S(),i.classList.add("modal-hidden"),document.body.classList.remove("overflow-hidden"),document.getElementById("confirmation-modal").classList.add("modal-hidden"),document.getElementById("success-message").classList.add("hidden"),x.disabled=!1,D.disabled=!1,A.innerText=e[t].ConfirmButton},1e3)},800)}).catch(n=>{console.error("Error submitting to Google Sheet:",n),alert("An error occurred while submitting your order. Please try again."),F(),x.disabled=!1,D.disabled=!1,A.innerText=e[t].ConfirmButton})}),document.addEventListener("DOMContentLoaded",()=>{l(localStorage.getItem("selectedLang")||"en");let e=0;const t=document.querySelector("header");window.addEventListener("scroll",function(){let n=window.pageYOffset||document.documentElement.scrollTop;n>e&&n>t.offsetHeight?t.style.top=`-${t.offsetHeight+10}px`:t.style.top="0",e=n<=0?0:n},!1),S()});
