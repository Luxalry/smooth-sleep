window.addEventListener("scroll",()=>{const e=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100;e>=25&&dataLayer.push({event:"scroll_depth",scroll_percentage:25}),e>=50&&dataLayer.push({event:"scroll_depth",scroll_percentage:50}),e>=75&&dataLayer.push({event:"scroll_depth",scroll_percentage:75}),e>=90&&dataLayer.push({event:"scroll_depth",scroll_percentage:90})},{passive:!0}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('a[href="#order-btn"], a[href="#order-btn-fr"], a[href="#order-btn-ar"], button[onclick^="openCheckoutModal"]').forEach(e=>{e.addEventListener("click",()=>{dataLayer.push({event:"cta_click",cta_label:e.innerText||"Buy Now"})})})});const e={en:{CompleteOrder:"Complete Your Order",FillDetails:"Fill out the details below to checkout.",ProductDetails:"Product Details",ProductName:"Smooth Sleep",Quantity:"Quantity",SelectQuantity:"Select a quantity",Bottle1:"1 Bottle",Bottle3:"3 Bottles",Bottle5:"5 Bottles",YourDetails:"Your Details",FullName:"Full Name",FullNamePlaceholder:"Enter Your Name*",PhoneNumber:"Phone Number",PhoneNumberPlaceholder:"+212 600-000000",ConfirmPhoneNumber:"Confirm Phone Number",ConfirmPhoneNumberPlaceholder:"Re-enter phone number",FullAddress:"Full Address",FullAddressPlaceholder:"Street, City, etc.",ValidPhone:"Please enter a valid phone number.",PhoneMismatch:"Phone numbers do not match.",SubmitOrder:"Submit Order",OrderConfirmed:"Order Confirmed!",Redirecting:"Redirecting to WhatsApp...",ConfirmDetails:"Please Confirm Your Details",OrderID:"Order ID",ConfirmName:"Name",ConfirmPhone:"Phone",ConfirmAddress:"Address",ConfirmCallTime:"Consultation Time",ConfirmDeliveryNote:"Delivery Note",ConfirmQuantity:"Quantity",ConfirmPrice:"Price",ConfirmCorrect:"Is this information correct?",EditButton:"No, Edit",ConfirmButton:"Yes, Go!",Processing:"Processing...",Next:"Next",Back:"Back",AdditionalInfo:"Additional Info",CallTime:"Preferred call time for free consultation",DeliveryNote:"Delivery Note (Optional)",DeliveryNotePlaceholder:"e.g., leave with the concierge, call upon arrival...",ClientNote:"(Client Note): please call me at {time} for consultation and confirmation",SellerNote:"(Seller Note): im replacing confirmation call to consultation call to convert maximum leads to delivered orders"},fr:{CompleteOrder:"ComplÃ©tez votre commande",FillDetails:"Remplissez les dÃ©tails ci-dessous pour finaliser.",ProductDetails:"DÃ©tails du produit",ProductName:"Smooth Sleep",Quantity:"QuantitÃ©",SelectQuantity:"SÃ©lectionnez une quantitÃ©",Bottle1:"1 Bouteille",Bottle3:"3 Bouteilles",Bottle5:"5 Bouteilles",YourDetails:"Vos coordonnÃ©es",FullName:"Nom complet",FullNamePlaceholder:"Entrez votre nom complet*",PhoneNumber:"NumÃ©ro de tÃ©lÃ©phone",PhoneNumberPlaceholder:"+212 600-000000",ConfirmPhoneNumber:"Confirmez le numÃ©ro de tÃ©lÃ©phone",ConfirmPhoneNumberPlaceholder:"Retapez le numÃ©ro de tÃ©lÃ©phone",FullAddress:"Adresse complÃ¨te",FullAddressPlaceholder:"Rue, Ville, etc.",ValidPhone:"Veuillez entrer un numÃ©ro de tÃ©lÃ©phone valide.",PhoneMismatch:"Les numÃ©ros de tÃ©lÃ©phone ne correspondent pas.",SubmitOrder:"Valider la commande",OrderConfirmed:"Commande confirmÃ©e !",Redirecting:"Redirection vers WhatsApp...",ConfirmDetails:"Veuillez confirmer vos informations",OrderID:"ID de commande",ConfirmName:"Nom",ConfirmPhone:"TÃ©lÃ©phone",ConfirmAddress:"Adresse",ConfirmCallTime:"Heure de consultation",ConfirmDeliveryNote:"Note de livraison",ConfirmQuantity:"QuantitÃ©",ConfirmPrice:"Prix",ConfirmCorrect:"Ces informations sont-elles correctes ?",EditButton:"Non, Modifier",ConfirmButton:"Oui, Continuer !",Processing:"Traitement...",Next:"Suivant",Back:"Retour",AdditionalInfo:"Informations supplÃ©mentaires",CallTime:"Heure d'appel prÃ©fÃ©rÃ©e pour la consultation gratuite",DeliveryNote:"Note de livraison (Facultatif)",DeliveryNotePlaceholder:"ex: laisser chez le concierge, appeler Ã  l'arrivÃ©e...",ClientNote:"(Note client) : veuillez m'appeler au {time} pour consultation et confirmation",SellerNote:"(Note du vendeur) : je remplace l'appel de confirmation par un appel de consultation pour convertir un maximum de prospects en commandes livrÃ©es"},ar:{CompleteOrder:"Ø£ÙƒÙ…Ù„ Ø·Ù„Ø¨Ùƒ",FillDetails:"Ø§Ù…Ù„Ø£ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø£Ø¯Ù†Ø§Ù‡ Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡.",ProductDetails:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬",ProductName:"Ø³Ù…ÙˆØ« Ø³Ù„ÙŠØ¨",Quantity:"Ø§Ù„ÙƒÙ…ÙŠØ©",SelectQuantity:"Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ…ÙŠØ©",Bottle1:"Ø²Ø¬Ø§Ø¬Ø© ÙˆØ§Ø­Ø¯Ø©",Bottle3:"3 Ø²Ø¬Ø§Ø¬Ø§Øª",Bottle5:"5 Ø²Ø¬Ø§Ø¬Ø§Øª",YourDetails:"ØªÙØ§ØµÙŠÙ„Ùƒ Ø§Ù„Ø´Ø®ØµÙŠØ©",FullName:"Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",FullNamePlaceholder:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„*",PhoneNumber:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",PhoneNumberPlaceholder:"+212 600-000000",ConfirmPhoneNumber:"ØªØ£ÙƒÙŠØ¯ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",ConfirmPhoneNumberPlaceholder:"Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",FullAddress:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„",FullAddressPlaceholder:"Ø§Ù„Ø´Ø§Ø±Ø¹ØŒ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø¥Ù„Ø®.",ValidPhone:"Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­.",PhoneMismatch:"Ø±Ù‚Ù…Ø§ Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ÙŠÙ†.",SubmitOrder:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨",OrderConfirmed:"ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨!",Redirecting:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨...",ConfirmDetails:"Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ",OrderID:"Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨",ConfirmName:"Ø§Ù„Ø§Ø³Ù…",ConfirmPhone:"Ø§Ù„Ù‡Ø§ØªÙ",ConfirmAddress:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",ConfirmCallTime:"ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø©",ConfirmDeliveryNote:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ…",ConfirmQuantity:"Ø§Ù„ÙƒÙ…ÙŠØ©",ConfirmPrice:"Ø§Ù„Ø³Ø¹Ø±",ConfirmCorrect:"Ù‡Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ­Ø©ØŸ",EditButton:"Ù„Ø§ØŒ ØªØ¹Ø¯ÙŠÙ„",ConfirmButton:"Ù†Ø¹Ù…ØŒ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨!",Processing:"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...",Next:"Ø§Ù„ØªØ§Ù„ÙŠ",Back:"Ø±Ø¬ÙˆØ¹",AdditionalInfo:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©",CallTime:"Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ÙØ¶Ù„ Ù„Ù„Ø§ØªØµØ§Ù„ Ù„Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©",DeliveryNote:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",DeliveryNotePlaceholder:"Ù…Ø«Ø§Ù„: Ø§ØªØ±ÙƒÙ‡Ø§ Ù…Ø¹ Ø§Ù„Ø¨ÙˆØ§Ø¨ØŒ Ø§ØªØµÙ„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„...",ClientNote:"(Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„): ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨ÙŠ Ø¹Ù„Ù‰ {time} Ù„Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯",SellerNote:"(Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø¨Ø§Ø¦Ø¹): Ø£Ù‚ÙˆÙ… Ø¨Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù…ÙƒØ§Ù„Ù…Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¨Ù…ÙƒØ§Ù„Ù…Ø© Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙ…Ù„ÙŠÙ† Ø¥Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª ØªÙ… ØªØ³Ù„ÙŠÙ…Ù‡Ø§"}};let t=localStorage.getItem("selectedLang")||"en";document.getElementById("page-content");const n=document.querySelectorAll(".lang-content"),o=document.querySelectorAll(".lang-switcher"),r=document.documentElement;function l(l){t=l,localStorage.setItem("selectedLang",l),r.lang=l;const i=document.getElementById("checkout-modal-body"),d=document.getElementById("form-container");"ar"===l?(i.classList.add("rtl"),i.classList.remove("ltr"),d.setAttribute("dir","rtl")):(i.classList.add("ltr"),i.classList.remove("rtl"),d.setAttribute("dir","ltr"));const a=document.getElementById("confirmation-details-box");a&&("ar"===l?(a.setAttribute("dir","rtl"),a.classList.remove("text-left"),a.classList.add("text-right")):(a.setAttribute("dir","ltr"),a.classList.remove("text-right"),a.classList.add("text-left"))),n.forEach(e=>{e.classList.remove("active"),e.id===`lang-${l}`&&e.classList.add("active")}),o.forEach(e=>{e.classList.remove("bg-indigo-600","text-white","shadow-md"),e.classList.add("text-gray-600"),e.dataset.lang===l&&(e.classList.add("bg-indigo-600","text-white","shadow-md"),e.classList.remove("text-gray-600"))}),function(n){document.getElementById("form-container")&&(t=n,document.querySelectorAll("[data-lang-key]").forEach(t=>{const o=t.getAttribute("data-lang-key");e[n]&&e[n][o]&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName?t.placeholder=e[n][o]:t.innerText=e[n][o])}))}(l)}document.querySelectorAll(".faq-question").forEach(e=>{e.addEventListener("click",()=>{const t=e.classList.contains("active");document.querySelectorAll(".faq-question").forEach(e=>e.classList.remove("active")),t||e.classList.add("active")})});const i=document.getElementById("checkout-modal-body"),d=document.getElementById("product-variant"),a=document.getElementById("product-price"),c="MAD",s=document.getElementById("form-step-1"),m=document.getElementById("form-step-2"),u=document.getElementById("form-step-3"),h=document.getElementById("next-button"),f=document.getElementById("next-button-step2"),p=document.getElementById("back-button-step2"),g=document.getElementById("back-button-step3");function y(e){s.classList.toggle("hidden",1!==e),m.classList.toggle("hidden",2!==e),u.classList.toggle("hidden",3!==e)}h.addEventListener("click",()=>{d.checkValidity()?y(2):d.reportValidity()}),f.addEventListener("click",()=>{if(E.checkValidity()&&C.checkValidity()&&N.checkValidity()&&B.checkValidity()){if(C.value.trim().length<9)return b.classList.remove("hidden"),void C.focus();if(C.value!==N.value)return I.classList.remove("hidden"),void N.focus();b.classList.add("hidden"),I.classList.add("hidden"),y(3)}else v.reportValidity()}),p.addEventListener("click",()=>{y(1)}),g.addEventListener("click",()=>{y(2)});const v=document.getElementById("checkout-form"),E=document.getElementById("full-name"),C=document.getElementById("phone-number"),N=document.getElementById("confirm-phone-number"),B=document.getElementById("full-address"),b=document.getElementById("phone-format-error"),I=document.getElementById("phone-mismatch-error"),P=document.getElementById("confirmation-modal"),L=document.getElementById("modal-content-confirm"),x=document.getElementById("confirm-button"),A=document.getElementById("confirm-button-text"),D=document.getElementById("edit-button"),T=document.getElementById("success-message"),k=document.getElementById("submit-button");function S(){a.innerHTML=`--.-- ${c}`}function F(){L.style.transform="scale(0.95)",L.style.opacity="0",k.parentElement.classList.remove("hidden"),setTimeout(()=>{P.classList.add("modal-hidden")},300)}D.addEventListener("click",function(){F(),document.getElementById("submit-button").classList.remove("hidden")}),d.addEventListener("change",function(e){const t=e.target.options[e.target.selectedIndex],n=t.getAttribute("data-price"),o=t.getAttribute("data-old-price");if(n&&"0"!==n){let e=`<span>${parseFloat(n).toFixed(0)} ${c}</span>`;o&&parseFloat(o)>parseFloat(n)&&(e+=` <s class="text-red-500 font-normal text-lg ml-2">${parseFloat(o).toFixed(0)} ${c}</s>`),a.innerHTML=e}else S()}),v.addEventListener("submit",function(n){n.preventDefault();const o=d.options[d.selectedIndex];document.getElementById("confirm-order-id").innerText=function(){const e=Date.now().toString();return`LXLY-3126-${e.substring(e.length-6)}`}(),document.getElementById("confirm-name").innerText=E.value,document.getElementById("confirm-phone").innerText=C.value,document.getElementById("confirm-address").innerText=B.value,document.getElementById("confirm-call-time").innerText=document.getElementById("note").value,document.getElementById("confirm-delivery-note").innerText=document.getElementById("delivery-note").value||"N/A",document.getElementById("confirm-variant").innerText=e[t][o.getAttribute("data-lang-key")],document.getElementById("confirm-price").innerText=`${parseFloat(o.getAttribute("data-price")).toFixed(0)} ${c}`,P.classList.remove("modal-hidden"),k.parentElement.classList.add("hidden"),setTimeout(()=>{L.style.transform="scale(1)",L.style.opacity="1"},50),document.getElementById("submit-button").classList.add("hidden")}),x.addEventListener("click",function(){x.disabled=!0,D.disabled=!0,A.innerText=e[t].Processing;const n=d.options[d.selectedIndex],o=parseFloat(n.getAttribute("data-price")).toFixed(0);let r=C.value.trim();9===r.length&&(r.startsWith("6")||r.startsWith("7"))&&(r="0"+r);const l="'"+r,a=document.getElementById("confirm-order-id").innerText,s=document.getElementById("product-title").innerText,m=document.getElementById("sku").value,u=document.getElementById("note").value,h=`${e[t].ClientNote.replace("{time}",u)}\n${e[t].SellerNote}`,f={orderId:a,productTitle:s,sku:m,productPrice:`${o} ${c}`,productVariant:d.value,clientName:E.value,clientPhone:l,clientAddress:B.value,note:h,delivery_note:document.getElementById("delivery-note").value},p=`https://wa.me/212768356015?text=${encodeURIComponent(`*New Order* ðŸ”¥\n-------------------\n*Order ID:* ${a}\n\n*Product:* ${s}\n*SKU:* ${f.sku}\n*Quantity:* ${f.productVariant} bottle(s)\n*Price:* ${f.productPrice}\n\n*Client Details:*\n*Name:* ${f.clientName}\n*Phone:* ${r}\n*Address:* ${f.clientAddress}\n\n*Consultation & Notes:*\n${f.note}\n\n*Delivery Note:* ${f.delivery_note||"None"}`.trim())}`;fetch("https://script.google.com/macros/s/AKfycbwDyvrE3gVhvxUPiXLwk_M_p_z-vO1acq2nljXK10HonrJCkne00zNIKhx7lecE5cc2ug/exec",{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}).then(()=>{var n;F(),T.classList.remove("hidden"),n={orderId:f.orderId,productPrice:o,productVariant:f.productVariant,productTitle:f.productTitle,sku:f.sku},dataLayer.push({event:"purchase",ecommerce:{transaction_id:n.orderId,value:n.productPrice,currency:"MAD",items:[{item_id:n.sku,item_name:n.productTitle,quantity:n.productVariant,price:n.productPrice}]}}),setTimeout(()=>{window.open(p,"_blank"),setTimeout(()=>{v.reset(),S(),i.classList.add("modal-hidden"),document.body.classList.remove("overflow-hidden"),document.getElementById("confirmation-modal").classList.add("modal-hidden"),document.getElementById("success-message").classList.add("hidden"),x.disabled=!1,D.disabled=!1,A.innerText=e[t].ConfirmButton},1e3)},800)}).catch(n=>{console.error("Error submitting to Google Sheet:",n),alert("An error occurred while submitting your order. Please try again."),F(),x.disabled=!1,D.disabled=!1,A.innerText=e[t].ConfirmButton})}),document.addEventListener("DOMContentLoaded",()=>{l(localStorage.getItem("selectedLang")||"en");let e=0;const t=document.querySelector("header");window.addEventListener("scroll",function(){let n=window.pageYOffset||document.documentElement.scrollTop;n>e&&n>t.offsetHeight?t.style.top=`-${t.offsetHeight+10}px`:t.style.top="0",e=n<=0?0:n},!1),S()});
